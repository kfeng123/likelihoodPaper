S=cov(X)
X_bar=colMeans(X)
dim(X_bar)=c(p,1)
T=(n*t(X_bar)%*%X_bar-sum(diag(S)))/(2*(n-1)*n/(n-2)/(n+1)*(sum(diag(S%*%S))-sum(diag(S))^2/(n-1)))^(1/2)
1-pnorm(T)
}
new_likelihood_pvalue=function(X){
B=100
calc_T=function(X){
S=cov(X)
X_bar=colMeans(X)
dim(X_bar)=c(p,1)
t(X_bar)%*%solve(diag(p)/n+S)%*%X_bar
}
myT=calc_T(X)
random_stat=NULL
for(i in 1:B){
the_sign=sample(c(-1,1),n,replace=TRUE)
the_sign=diag(the_sign)
random_stat[i]=calc_T(the_sign%*%X)
}
sum(random_stat>as.numeric(myT))/B
}
hh=NULL
newHH=NULL
for(i in 1:100){
X=rnorm(n*p,0,1)
dim(X)=c(n,p)
X[,1]=X[,1]/10
X[,1]=X[,1]+0.8
X[,2:p]=X[,2:p]+0.01
hh[i]=Bai_test_pvalue(X)
newHH[i]=new_likelihood_pvalue(X)
}
hist(hh)
hist(newHH)
sum(hh<0.05)/100
sum(newHH<0.05)/100
n=40
p=100
Bai_test_pvalue=function(X){
S=cov(X)
X_bar=colMeans(X)
dim(X_bar)=c(p,1)
T=(n*t(X_bar)%*%X_bar-sum(diag(S)))/(2*(n-1)*n/(n-2)/(n+1)*(sum(diag(S%*%S))-sum(diag(S))^2/(n-1)))^(1/2)
1-pnorm(T)
}
new_likelihood_pvalue=function(X){
B=100
calc_T=function(X){
S=cov(X)
X_bar=colMeans(X)
dim(X_bar)=c(p,1)
t(X_bar)%*%solve(diag(p)/n+S)%*%X_bar
}
myT=calc_T(X)
random_stat=NULL
for(i in 1:B){
the_sign=sample(c(-1,1),n,replace=TRUE)
the_sign=diag(the_sign)
random_stat[i]=calc_T(the_sign%*%X)
}
sum(random_stat>as.numeric(myT))/B
}
hh=NULL
newHH=NULL
for(i in 1:100){
X=rnorm(n*p,0,1)
dim(X)=c(n,p)
X[,1]=X[,1]/sqrt(1000)
X[,1]=X[,1]+0.8
X[,2:p]=X[,2:p]+0.01
hh[i]=Bai_test_pvalue(X)
newHH[i]=new_likelihood_pvalue(X)
}
hist(hh)
hist(newHH)
sum(hh<0.05)/100
sum(newHH<0.05)/100
n=40
p=100
Bai_test_pvalue=function(X){
S=cov(X)
X_bar=colMeans(X)
dim(X_bar)=c(p,1)
T=(n*t(X_bar)%*%X_bar-sum(diag(S)))/(2*(n-1)*n/(n-2)/(n+1)*(sum(diag(S%*%S))-sum(diag(S))^2/(n-1)))^(1/2)
1-pnorm(T)
}
new_likelihood_pvalue=function(X){
B=100
calc_T=function(X){
S=cov(X)
X_bar=colMeans(X)
dim(X_bar)=c(p,1)
t(X_bar)%*%solve(diag(p)/n+S)%*%X_bar
}
myT=calc_T(X)
random_stat=NULL
for(i in 1:B){
the_sign=sample(c(-1,1),n,replace=TRUE)
the_sign=diag(the_sign)
random_stat[i]=calc_T(the_sign%*%X)
}
sum(random_stat>as.numeric(myT))/B
}
hh=NULL
newHH=NULL
for(i in 1:100){
X=rnorm(n*p,0,1)
dim(X)=c(n,p)
X[,1]=X[,1]/sqrt(10000)
X[,1]=X[,1]+0.8
X[,2:p]=X[,2:p]+0.01
hh[i]=Bai_test_pvalue(X)
newHH[i]=new_likelihood_pvalue(X)
}
hist(hh)
hist(newHH)
sum(hh<0.05)/100
sum(newHH<0.05)/100
n=40
p=100
Bai_test_pvalue=function(X){
S=cov(X)
X_bar=colMeans(X)
dim(X_bar)=c(p,1)
T=(n*t(X_bar)%*%X_bar-sum(diag(S)))/(2*(n-1)*n/(n-2)/(n+1)*(sum(diag(S%*%S))-sum(diag(S))^2/(n-1)))^(1/2)
1-pnorm(T)
}
new_likelihood_pvalue=function(X){
B=100
calc_T=function(X){
S=cov(X)
X_bar=colMeans(X)
dim(X_bar)=c(p,1)
t(X_bar)%*%solve(diag(p)/n+S)%*%X_bar
}
myT=calc_T(X)
random_stat=NULL
for(i in 1:B){
the_sign=sample(c(-1,1),n,replace=TRUE)
the_sign=diag(the_sign)
random_stat[i]=calc_T(the_sign%*%X)
}
sum(random_stat>as.numeric(myT))/B
}
hh=NULL
newHH=NULL
for(i in 1:100){
X=rnorm(n*p,0,1)
dim(X)=c(n,p)
X[,1]=X[,1]/sqrt(10000)
X[,1]=X[,1]+0.8
X[,2:p]=X[,2:p]+0.01
hh[i]=Bai_test_pvalue(X)
newHH[i]=new_likelihood_pvalue(X)
}
hist(hh)
hist(newHH)
sum(hh<0.05)/100
sum(newHH<0.05)/100
seq(0,2,0.1)
n=5
p=10
Bai_test_pvalue=function(X){
S=cov(X)
X_bar=colMeans(X)
dim(X_bar)=c(p,1)
T=(n*t(X_bar)%*%X_bar-sum(diag(S)))/(2*(n-1)*n/(n-2)/(n+1)*(sum(diag(S%*%S))-sum(diag(S))^2/(n-1)))^(1/2)
1-pnorm(T)
}
new_likelihood_pvalue=function(X){
B=100
calc_T=function(X){
S=cov(X)
X_bar=colMeans(X)
dim(X_bar)=c(p,1)
t(X_bar)%*%solve(diag(p)/n+S)%*%X_bar
}
myT=calc_T(X)
random_stat=NULL
for(i in 1:B){
the_sign=sample(c(-1,1),n,replace=TRUE)
the_sign=diag(the_sign)
random_stat[i]=calc_T(the_sign%*%X)
}
sum(random_stat>as.numeric(myT))/B
}
jjie1=NULL
jjie2=NULL
k=0
for(c in seq(0,2,0.1)){
k=k+1
hh=NULL
newHH=NULL
for(i in 1:1000){
X=rnorm(n*p,0,1)
dim(X)=c(n,p)
X[,1]=X[,1]/sqrt(100)
X[,1]=X[,1]+1*c
X[,2:p]=X[,2:p]+0.01*c
hh[i]=Bai_test_pvalue(X)
newHH[i]=new_likelihood_pvalue(X)
}
hist(hh)
hist(newHH)
jjie1[k]=sum(hh<0.05)/1000
jjie2[k]=sum(newHH<0.05)/1000
}
c
X
k
n=5
p=10
Bai_test_pvalue=function(X){
S=cov(X)
X_bar=colMeans(X)
dim(X_bar)=c(p,1)
T=(n*t(X_bar)%*%X_bar-sum(diag(S)))/(2*(n-1)*n/(n-2)/(n+1)*(sum(diag(S%*%S))-sum(diag(S))^2/(n-1)))^(1/2)
1-pnorm(T)
}
new_likelihood_pvalue=function(X){
B=10
calc_T=function(X){
S=cov(X)
X_bar=colMeans(X)
dim(X_bar)=c(p,1)
t(X_bar)%*%solve(diag(p)/n+S)%*%X_bar
}
myT=calc_T(X)
random_stat=NULL
for(i in 1:B){
the_sign=sample(c(-1,1),n,replace=TRUE)
the_sign=diag(the_sign)
random_stat[i]=calc_T(the_sign%*%X)
}
sum(random_stat>as.numeric(myT))/B
}
jjie1=NULL
jjie2=NULL
k=0
for(c in seq(0,2,0.1)){
k=k+1
hh=NULL
newHH=NULL
for(i in 1:1000){
X=rnorm(n*p,0,1)
dim(X)=c(n,p)
X[,1]=X[,1]/sqrt(100)
X[,1]=X[,1]+1*c
X[,2:p]=X[,2:p]+0.01*c
hh[i]=Bai_test_pvalue(X)
newHH[i]=new_likelihood_pvalue(X)
}
hist(hh)
hist(newHH)
jjie1[k]=sum(hh<0.05)/1000
jjie2[k]=sum(newHH<0.05)/1000
}
plot(jjie1)
line(jjie2)
plot(jjie2)
n=10
p=10
Bai_test_pvalue=function(X){
S=cov(X)
X_bar=colMeans(X)
dim(X_bar)=c(p,1)
T=(n*t(X_bar)%*%X_bar-sum(diag(S)))/(2*(n-1)*n/(n-2)/(n+1)*(sum(diag(S%*%S))-sum(diag(S))^2/(n-1)))^(1/2)
1-pnorm(T)
}
new_likelihood_pvalue=function(X){
B=10
calc_T=function(X){
S=cov(X)
X_bar=colMeans(X)
dim(X_bar)=c(p,1)
t(X_bar)%*%solve(diag(p)/n+S)%*%X_bar
}
myT=calc_T(X)
random_stat=NULL
for(i in 1:B){
the_sign=sample(c(-1,1),n,replace=TRUE)
the_sign=diag(the_sign)
random_stat[i]=calc_T(the_sign%*%X)
}
sum(random_stat>as.numeric(myT))/B
}
jjie1=NULL
jjie2=NULL
k=0
for(c in seq(0,2,0.1)){
k=k+1
hh=NULL
newHH=NULL
for(i in 1:1000){
X=rnorm(n*p,0,1)
dim(X)=c(n,p)
X[,1]=X[,1]/sqrt(100)
X[,1]=X[,1]+1*c
X[,2:p]=X[,2:p]+0.01*c
hh[i]=Bai_test_pvalue(X)
newHH[i]=new_likelihood_pvalue(X)
}
#hist(hh)
#hist(newHH)
jjie1[k]=sum(hh<0.05)/1000
jjie2[k]=sum(newHH<0.05)/1000
}
plot(jjie1)
plot(jjie2)
n=10
p=10
Bai_test_pvalue=function(X){
S=cov(X)
X_bar=colMeans(X)
dim(X_bar)=c(p,1)
T=(n*t(X_bar)%*%X_bar-sum(diag(S)))/(2*(n-1)*n/(n-2)/(n+1)*(sum(diag(S%*%S))-sum(diag(S))^2/(n-1)))^(1/2)
1-pnorm(T)
}
new_likelihood_pvalue=function(X){
B=10
calc_T=function(X){
S=cov(X)
X_bar=colMeans(X)
dim(X_bar)=c(p,1)
t(X_bar)%*%solve(diag(p)/n+S)%*%X_bar
}
myT=calc_T(X)
random_stat=NULL
for(i in 1:B){
the_sign=sample(c(-1,1),n,replace=TRUE)
the_sign=diag(the_sign)
random_stat[i]=calc_T(the_sign%*%X)
}
sum(random_stat>as.numeric(myT))/B
}
jjie1=NULL
jjie2=NULL
k=0
for(c in seq(0,2,0.1)){
k=k+1
hh=NULL
newHH=NULL
for(i in 1:1000){
X=rnorm(n*p,0,1)
dim(X)=c(n,p)
X[,1]=X[,1]/sqrt(100)
X[,1]=X[,1]+1*c
X[,2:p]=X[,2:p]+1*c
hh[i]=Bai_test_pvalue(X)
newHH[i]=new_likelihood_pvalue(X)
}
#hist(hh)
#hist(newHH)
jjie1[k]=sum(hh<0.05)/1000
jjie2[k]=sum(newHH<0.05)/1000
}
plot(jjie1)
plot(jjie2)
jjie1
jjie2
n=50
p=100
Bai_test_pvalue=function(X){
S=cov(X)
X_bar=colMeans(X)
dim(X_bar)=c(p,1)
T=(n*t(X_bar)%*%X_bar-sum(diag(S)))/(2*(n-1)*n/(n-2)/(n+1)*(sum(diag(S%*%S))-sum(diag(S))^2/(n-1)))^(1/2)
1-pnorm(T)
}
new_likelihood_pvalue=function(X){
B=10
calc_T=function(X){
S=cov(X)
X_bar=colMeans(X)
dim(X_bar)=c(p,1)
t(X_bar)%*%solve(diag(p)/n+S)%*%X_bar
}
myT=calc_T(X)
random_stat=NULL
for(i in 1:B){
the_sign=sample(c(-1,1),n,replace=TRUE)
the_sign=diag(the_sign)
random_stat[i]=calc_T(the_sign%*%X)
}
sum(random_stat>as.numeric(myT))/B
}
jjie1=NULL
jjie2=NULL
k=0
for(c in seq(0,2,0.1)){
k=k+1
hh=NULL
newHH=NULL
for(i in 1:100){
X=rnorm(n*p,0,1)
dim(X)=c(n,p)
X[,1]=X[,1]/sqrt(100)
X[,1]=X[,1]+1*c
X[,2:p]=X[,2:p]+0.01*c
hh[i]=Bai_test_pvalue(X)
newHH[i]=new_likelihood_pvalue(X)
}
#hist(hh)
#hist(newHH)
jjie1[k]=sum(hh<0.05)/100
jjie2[k]=sum(newHH<0.05)/100
}
k
n=50
p=100
Bai_test_pvalue=function(X){
S=cov(X)
X_bar=colMeans(X)
dim(X_bar)=c(p,1)
T=(n*t(X_bar)%*%X_bar-sum(diag(S)))/(2*(n-1)*n/(n-2)/(n+1)*(sum(diag(S%*%S))-sum(diag(S))^2/(n-1)))^(1/2)
1-pnorm(T)
}
new_likelihood_pvalue=function(X){
B=10
calc_T=function(X){
S=cov(X)
X_bar=colMeans(X)
dim(X_bar)=c(p,1)
t(X_bar)%*%solve(diag(p)/n+S)%*%X_bar
}
myT=calc_T(X)
random_stat=NULL
for(i in 1:B){
the_sign=sample(c(-1,1),n,replace=TRUE)
the_sign=diag(the_sign)
random_stat[i]=calc_T(the_sign%*%X)
}
sum(random_stat>as.numeric(myT))/B
}
jjie1=NULL
jjie2=NULL
k=0
for(c in seq(0,2,0.1)){
k=k+1
hh=NULL
newHH=NULL
for(i in 1:100){
X=rnorm(n*p,0,1)
dim(X)=c(n,p)
X[,1]=X[,1]/sqrt(100)
X[,1]=X[,1]+1*c
X[,2:p]=X[,2:p]+0.01*c
hh[i]=Bai_test_pvalue(X)
newHH[i]=new_likelihood_pvalue(X)
}
#hist(hh)
#hist(newHH)
jjie1[k]=sum(hh<0.05)/100
jjie2[k]=sum(newHH<0.05)/100
}
jjie1
jjie2
plot(jjie1)
plot(jjie2)
n=40
p=100
Bai_test_pvalue=function(X){
S=cov(X)
X_bar=colMeans(X)
dim(X_bar)=c(p,1)
T=(n*t(X_bar)%*%X_bar-sum(diag(S)))/(2*(n-1)*n/(n-2)/(n+1)*(sum(diag(S%*%S))-sum(diag(S))^2/(n-1)))^(1/2)
1-pnorm(T)
}
new_likelihood_pvalue=function(X){
B=10
calc_T=function(X){
S=cov(X)
X_bar=colMeans(X)
dim(X_bar)=c(p,1)
t(X_bar)%*%solve(diag(p)/n+S)%*%X_bar
}
myT=calc_T(X)
random_stat=NULL
for(i in 1:B){
the_sign=sample(c(-1,1),n,replace=TRUE)
the_sign=diag(the_sign)
random_stat[i]=calc_T(the_sign%*%X)
}
sum(random_stat>as.numeric(myT))/B
}
jjie1=NULL
jjie2=NULL
k=0
for(c in seq(0,2,0.1)){
k=k+1
hh=NULL
newHH=NULL
for(i in 1:100){
X=rnorm(n*p,0,1)
dim(X)=c(n,p)
X[,1]=X[,1]/sqrt(100)
X[,1]=X[,1]+1*c
X[,2:p]=X[,2:p]+0.01*c
hh[i]=Bai_test_pvalue(X)
newHH[i]=new_likelihood_pvalue(X)
}
#hist(hh)
#hist(newHH)
jjie1[k]=sum(hh<0.05)/100
jjie2[k]=sum(newHH<0.05)/100
}
plot(jjie1)
plot(jjie2)
jjie1
jjie2
